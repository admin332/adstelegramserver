

## Задача

Изменить частоту запуска cron job с каждой минуты на каждый час (в начале часа: 00:00, 01:00, 02:00 и т.д.), так как посты планируются на целые часы.

## Текущее состояние

```sql
-- Текущий cron job (jobid: 2)
schedule: '* * * * *'  -- каждую минуту = 1440 вызовов в сутки
```

Это избыточно, так как:
- Посты планируются только на целые часы (00:00, 01:00, 02:00...)
- Большинство вызовов возвращают "No posts to publish"
- Создает лишнюю нагрузку на сервер

## Решение

Изменить расписание cron job на `0 * * * *` — запуск в начале каждого часа (00 минут).

### SQL для изменения

```sql
-- Удалить старый cron job
SELECT cron.unschedule(2);

-- Создать новый с часовым интервалом
SELECT cron.schedule(
  'publish-scheduled-posts',
  '0 * * * *',  -- каждый час в 00 минут
  $$
  SELECT net.http_post(
    url:='https://fdxyittddmpyhaiijddp.supabase.co/functions/v1/publish-scheduled-posts',
    headers:='{"Content-Type": "application/json", "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}'::jsonb,
    body:='{}'::jsonb
  ) as request_id;
  $$
);
```

## Результат

| Метрика | Было | Станет |
|---------|------|--------|
| Частота | Каждую минуту | Каждый час |
| Вызовов в сутки | 1440 | 24 |
| Нагрузка | Высокая | Минимальная |

## Логика публикации

Edge Function уже оптимизирована:
1. Проверяет есть ли посты для публикации (`scheduled_at <= now()`)
2. Если нет — сразу возвращает ответ без дополнительных запросов
3. Обрабатывает только найденные сделки

Посты запланированные на 01:00 будут опубликованы при запуске cron в 01:00.

