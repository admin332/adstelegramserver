

## Автоопределение первой доступной даты при заказе рекламы

---

## Проблема

Сейчас при открытии формы заказа:
- Дата по умолчанию = сегодня (`new Date()`)
- Если владелец канала установил большой буфер (например, 48ч), то на сегодня нет слотов
- Рекламодатель видит сообщение "На сегодня нет доступных слотов"

---

## Решение

Автоматически устанавливать первую доступную дату при инициализации:

```text
minHoursBeforePost = 48ч
Сейчас: 31 января, 14:00

Минимальное время публикации: 2 февраля, 14:00
→ Дата по умолчанию: 2 февраля (а не 31 января)
```

---

## Изменения

### `src/components/channel/OrderDrawer.tsx`

**1. Вычислить первую доступную дату при инициализации:**

```typescript
// Было:
const [selectedDate, setSelectedDate] = useState(new Date());

// Станет:
const [selectedDate, setSelectedDate] = useState(() => {
  const now = new Date();
  const minTotalHours = Math.max(2, minHoursBeforePost);
  const minPublishTime = new Date(now.getTime() + minTotalHours * 60 * 60 * 1000);
  
  // Возвращаем дату минимальной публикации (без времени)
  const minDate = new Date(minPublishTime);
  minDate.setHours(0, 0, 0, 0);
  
  return minDate;
});
```

**2. Синхронизировать час с выбранной датой:**

Час уже вычисляется правильно, но нужно убедиться что он соответствует выбранной дате.

---

## Логика работы

| minHoursBeforePost | Текущее время | Первая доступная дата | Первый доступный час |
|--------------------|---------------|----------------------|---------------------|
| 2ч | 31 янв, 14:00 | 31 января | 16:00 |
| 24ч | 31 янв, 14:00 | 1 февраля | 14:00 |
| 48ч | 31 янв, 14:00 | 2 февраля | 14:00 |
| 72ч | 31 янв, 14:00 | 3 февраля | 14:00 |

---

## Дополнительно: отключить недоступные даты в календаре

### `src/components/channel/DateTimeSelector.tsx`

Сейчас календарь отключает только прошлые даты. Нужно также отключать даты до минимальной публикации:

```typescript
// Было:
disabled={(date) => date < new Date(new Date().setHours(0, 0, 0, 0))}

// Станет:
disabled={(date) => {
  const minTotalHours = Math.max(2, minHoursBeforePost);
  const minPublishTime = new Date(Date.now() + minTotalHours * 60 * 60 * 1000);
  const minPublishDate = new Date(minPublishTime);
  minPublishDate.setHours(0, 0, 0, 0);
  
  return date < minPublishDate;
}}
```

Это визуально покажет какие даты недоступны.

---

## Файлы для изменения

| Файл | Изменение |
|------|-----------|
| `src/components/channel/OrderDrawer.tsx` | Инициализация `selectedDate` с первой доступной датой |
| `src/components/channel/DateTimeSelector.tsx` | Отключение недоступных дат в календаре |

---

## Результат

- Рекламодатель сразу видит первую доступную дату
- Нет сообщения "На сегодня нет доступных слотов"
- Недоступные даты визуально отключены в календаре
- Первый доступный час автоматически выбран

